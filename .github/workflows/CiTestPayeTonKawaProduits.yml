name: CI_tests_unitaires_Produits


on:
  workflow_run:
    workflows: ["CI_tests_Build_Produits"]
    types:
      - completed
jobs:
  test:
    runs-on: ubuntu-latest

    steps:
    - name: ğŸš€ Cloner le code du dÃ©pÃ´t
      uses: actions/checkout@v4

    - name: âš™ï¸ Configurer l'environnement Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '20'
        cache: 'npm'  

    - name: ğŸ“¦ Installer les dÃ©pendances npm
      run: npm ci

    - name: ğŸ§ª Lancer les tests unitaires avec Jest
      run: npm test -- --coverage 
      env:
        DATABASE_URL: ${{ secrets.DATABASE_URL }}
        JWT_SECRET: ${{ secrets.JWT_SECRET }}
        JWT_EXPIRE: ${{ secrets.JWT_EXPIRE }}
        PORT: 3000
